(this["webpackJsonpsupermetrics-react-assignment"]=this["webpackJsonpsupermetrics-react-assignment"]||[]).push([[0],{23:function(e,t,n){e.exports=n(57)},28:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),s=n.n(c),i=(n(28),n(29),n(22)),l=n(1),o=n(7),u=n(2),m=n.n(u),f=n(6),d=n(3),p=(n(31),n(16)),_=n(32);function v(e,t){return fetch("".concat("https://api.supermetrics.com/assignment","/").concat(e),Object(p.a)({headers:{"content-type":"application/json"}},t)).then((function(e){return e.json()}))}function E(e,t){return v(e,{method:"POST",body:JSON.stringify(Object(p.a)({client_id:"ju16a6m81mhid5ue1z3v2g0uh"},t))})}function b(e,t){var n=e;return t&&(n+="?".concat(_.stringify(t))),v(n)}function h(e,t){return g.apply(this,arguments)}function g(){return(g=Object(f.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E("register",{name:t,email:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return j.apply(this,arguments)}function j(){return(j=Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=w(),e.abrupt("return",b("posts",{sl_token:t}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){var t={value:e.data.sl_token,expires:new Date(Date.now()+36e5)};localStorage.setItem("token",JSON.stringify(t))}function y(e,t){return S.apply(this,arguments)}function S(){return(S=Object(f.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t,n);case 2:N(e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){var e=function(){var e=localStorage.getItem("token");return e?JSON.parse(e):null}();return e?new Date(e.expires)<new Date?(localStorage.removeItem("token"),null):e.value:null}function k(){var e=Object(a.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(""),i=Object(d.a)(s,2),o=i[0],u=i[1],p=Object(a.useState)(!1),_=Object(d.a)(p,2),v=_[0],E=_[1],b=Object(a.useState)(null),h=Object(d.a)(b,2),g=h[0],O=h[1],j=Object(l.g)();function N(){return(N=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),E(!0),O(null),e.prev=3,e.next=6,y(n,o);case 6:j.push("/"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),O("Failed to login"),E(!1);case 13:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}return r.a.createElement("div",{className:"Login"},r.a.createElement("div",{className:"Login__box"},r.a.createElement("h1",null,"Login"),v&&r.a.createElement("div",{className:"Login__loading"},"Loading"),g&&r.a.createElement("div",{className:"Login_error"},"Login failed"),r.a.createElement("div",{className:"Login__form"},r.a.createElement("form",{onSubmit:function(e){return N.apply(this,arguments)}},r.a.createElement("div",{className:"Login__input"},r.a.createElement("label",null,"Name"),r.a.createElement("input",{type:"text",name:"name",value:n,onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",{className:"Login__input"},r.a.createElement("label",null,"Email"),r.a.createElement("input",{type:"email",name:"email",value:o,onChange:function(e){return u(e.target.value)}})),r.a.createElement("div",{className:"Login__submit"},r.a.createElement("button",{disabled:v},"Go"))))))}var x=n(8),L=n.n(x);n(51);function U(e){var t=e.from_name,n=e.from_id,a=e.message,c=e.created_time;return r.a.createElement("div",{className:"Post"},r.a.createElement("div",{className:"Post__header"},r.a.createElement("div",{className:"Post__fromName"},"by ",r.a.createElement(o.b,{to:"/".concat(n)},r.a.createElement("b",null,t))),r.a.createElement("div",{className:"Post__createdTime"},L()(c).format("MMMM D, YYYY, hh:mm:ss"))),r.a.createElement("div",{className:"Post__message"},a))}n(52);var C=n(10),F=n.n(C);n(53);function P(e){var t=e.acsending,n=e.setAcsending,a=e.searchQuery,c=e.setSearchQuery;return r.a.createElement("div",{className:"Filters"},r.a.createElement("div",{className:"Filters__sorting"},r.a.createElement("div",{className:F()({Filters__item:!0,Filters__descending:!0,Filters__selected:!t}),onClick:function(e){return n(!1)}},"Newest first"),r.a.createElement("div",{className:F()({Filters__item:!0,Filters__acsending:!0,Filters__selected:t}),onClick:function(e){n(!0)}},"Oldest first")),r.a.createElement("div",{className:"Filters__query"},r.a.createElement("input",{type:"text",value:a,placeholder:"search post",onChange:function(e){return c(e.target.value)}})))}function D(e){var t=e.posts,n=void 0===t?[]:t,c=Object(a.useState)(!1),s=Object(d.a)(c,2),i=s[0],l=s[1],o=Object(a.useState)(""),u=Object(d.a)(o,2),m=u[0],f=u[1],p=n.filter((function(e){return!m||-1!==e.message.toLowerCase().indexOf(m.toLowerCase())})).sort((function(e,t){return i?L()(e.created_time)-L()(t.created_time):L()(t.created_time)-L()(e.created_time)}));return r.a.createElement("div",{className:"Posts"},r.a.createElement("div",{className:"Posts__filters"},r.a.createElement(P,{acsending:i,setAcsending:l,searchQuery:m,setSearchQuery:f})),r.a.createElement("div",{className:"Posts__content"},p.map((function(e){return r.a.createElement(U,Object.assign({},e,{key:e.id}))}))))}n(54);function J(e){var t=e.from_id,n=e.from_name,a=e.post_count,c=e.selected,s=F()({User:!0,User__selected:c}),i=c?"/":"/".concat(t);return r.a.createElement("div",{className:s},r.a.createElement(o.b,{to:i},r.a.createElement("div",{className:"User__name"},n),r.a.createElement("div",{className:"User__count"},a)))}n(55);function M(e){var t=e.users,n=e.onUserSelect,c=e.selectedUser,s=Object(a.useState)(""),i=Object(d.a)(s,2),l=i[0],o=i[1],u=t.filter((function(e){return!l||-1!==e.from_name.toLowerCase().indexOf(l.toLowerCase())}));return r.a.createElement("div",{className:"Users"},r.a.createElement("div",{className:"Users__search"},r.a.createElement("input",{type:"text",value:l,placeholder:"search user",onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"Users__list"},u.map((function(e,t){return r.a.createElement(J,Object.assign({key:t},e,{selected:c===e.from_id,onUserSelect:function(){return n(e.from_id)}}))}))))}n(56);function I(e){var t=e.reduce((function(e,t){var n=t.from_id;return e[n]=e[n]||{from_id:t.from_id,from_name:t.from_name,post_count:0},e[n].post_count++,e}),{});return Object.keys(t).map((function(e){return t[e]})).sort((function(e,t){return e.from_name.localeCompare(t.from_name)}))}function Q(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)([]),i=Object(d.a)(s,2),o=i[0],u=i[1],p=Object(l.h)().selectedUser;function _(){return(_=Object(f.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:t=e.sent,n=t.data,c(n.posts),u(I(n.posts));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){!function(){_.apply(this,arguments)}()}),[]);var v=n.filter((function(e){return!p||e.from_id===p}));return r.a.createElement("div",{className:"Reader"},r.a.createElement("div",{className:"Reader__body"},r.a.createElement(M,{users:o,selectedUser:p}),r.a.createElement(D,{posts:v})))}function Y(e){return function(){return w()?e:r.a.createElement(l.a,{to:{pathname:"/login"}})}}function A(e){var t=e.children,n=Object(i.a)(e,["children"]);return r.a.createElement(l.b,Object.assign({},n,{render:Y(t)}))}var R=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(o.a,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/login"},r.a.createElement(k,null)),r.a.createElement(A,{path:"/:selectedUser"},r.a.createElement(Q,null)),r.a.createElement(A,{path:"/"},r.a.createElement(Q,null)))))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.4dd8235f.chunk.js.map